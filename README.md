# PINS’24 Compiler and Interpreter

## Introduction
Welcome to the PINS’24 Compiler and Interpreter project! This project implements a complete compiler and interpreter for the PINS’24 programming language. This README will guide you through the setup, usage, and internal structure of the project.

## Table of Contents
1. [Features](#features)
2. [Installation](#installation)
3. [Usage](#usage)
4. [Language Specifications](#language-specifications)
    - [Lexical Rules](#lexical-rules)
    - [Syntax Rules](#syntax-rules)
    - [Semantic Rules](#semantic-rules)
5. [Compiler Structure](#compiler-structure)
6. [Interpreter Structure](#interpreter-structure)

## Features
- **Lexical Analysis:** Tokenizes PINS’24 source code based on defined lexical rules.
- **Parsing:** Builds abstract syntax trees (ASTs) according to the context-free grammar of PINS’24.
- **Semantic Analysis:** Ensures the source code adheres to the semantic rules of PINS’24.
- **Code Generation:** Generates intermediate code for the PINS’24 stack machine.
- **Execution:** Interprets and executes the generated code on the PINS’24 stack machine.

## Installation
To install and set up the PINS’24 Compiler and Interpreter, follow these steps:

1. Clone the repository:
    ```sh
    git clone https://github.com/yourusername/pins24-compiler.git
    cd pins24-compiler
    ```

2. Compile the source code:
    ```sh
    make all
    ```

## Usage
To compile and run a PINS’24 program, use the following commands:

1. Compile a PINS’24 source file:
    Run CodeGen.java

2. Run the compiled program:
    Run Machine.java

## Language Specifications

### Lexical Rules
PINS’24 is written in ASCII and includes the following lexical elements:
- **Constants:**
  - Number: A non-empty sequence of decimal digits, optionally preceded by a sign (+ or -).
  - Character: A character in single quotes ('). Can be an ASCII character, newline (\n), or a hexadecimal code (\XX).
  - String: A sequence of characters in double quotes ("). Can include ASCII characters, newline (\n), or hexadecimal codes (\XX).
- **Symbols:** `= , && || ! == != > < >= <= + - * / % ^ ( )`
- **Identifiers:** A non-empty sequence of letters (A-Z, a-z), digits (0-9), and underscores (_), starting with a letter or underscore, and not being a keyword.
- **Keywords:** `fun var if then else while do let in end`
- **Comments:** Start with `#` and continue to the end of the line.
- **Whitespace:** Spaces, tabs (HT), line feeds (LF), and carriage returns (CR). Lines end with LF, and tabs are 8 characters wide.

### Syntax Rules
PINS’24 syntax is defined by a context-free grammar with the start symbol `program`. Look at the SynAn and Pins'24.pdf for more information.

## Compiler Structure
The PINS’24 compiler is organized into several stages, each responsible for a distinct part of the compilation process:

1. **Lexical Analysis:** This stage converts the source code into a sequence of tokens using the defined lexical rules.
2. **Parsing:** The parser takes tokens and constructs an abstract syntax tree (AST) based on the context-free grammar of PINS’24.
3. **Semantic Analysis:** The semantic analyzer checks the AST against the semantic rules, ensuring correct variable scope, type usage, and more.
4. **Code Generation:** This phase generates intermediate code suitable for the PINS’24 stack machine from the validated AST.
5. **Optimization:** (Optional) This phase improves the intermediate code performance without changing its output.
6. **Code Emission:** The final phase converts the optimized intermediate code into a machine code or bytecode format executable by the PINS’24 interpreter.

### Files and Directories
- `src/pins24/common`: Contains common utilities and shared code.
- `src/pins24/phase/Abstr`: Contains the abstract syntax tree (AST) classes.
- `src/pins24/phase/CodeGen`: Contains the code generation logic.
- `src/pins24/phase/LexAn`: Contains the lexical analysis (lexer) implementation.
- `src/pins24/phase/Machine`: Contains the machine-specific code and the stack machine.
- `src/pins24/phase/Memory`: Manages memory and runtime stack for the machine.
- `src/pins24/phase/SemAn`: Contains the semantic analysis logic.
- `src/pins24/phase/SynAn`: Contains the syntax analysis (parser) implementation.

## Interpreter Structure
The PINS’24 interpreter executes the machine code or bytecode generated by the compiler. It includes the following components:

1. **Stack Machine:** The core execution engine that operates on a stack, performing operations specified by the intermediate code.
2. **Instruction Set:** Defines the operations the stack machine can perform, such as LOAD, SAVE, PUSH, POP, etc.
3. **Runtime Environment:** Manages the execution state, including the instruction pointer (IP), stack pointer (SP), and frame pointer (FP).

### Files and Directories
- `src/pins24/phase/Machine`: Contains the stack machine and the instruction implementations.
- `src/pins24/phase/Memory`: Contains the runtime environment and related utilities.

## Example
Here is a simple example of a PINS’24 program, its compilation, and execution:

### Sample Program (source.pins)
```pins24
var x = 10
fun main() {
    let y = 20 in
    x = x + y
end
```

### Compilation
Run file `CodeGen.java`.

### Execution
Run file `Machine.java`.

This README provides a comprehensive overview of the PINS’24 compiler and interpreter project. For detailed language specifications, refer to the [PINS’24 Language Specification Document](pins24.pdf).
